{"ast":null,"code":"import _regeneratorRuntime from\"/Users/arpangoel/Documents/BookingSite/client/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/arpangoel/Documents/BookingSite/client/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/arpangoel/Documents/BookingSite/client/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/arpangoel/Documents/BookingSite/client/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faCircleXmark}from\"@fortawesome/free-solid-svg-icons\";import\"./reserve.css\";import useFetch from\"../../hooks/useFetch\";import{useContext,useState}from\"react\";import{AuthContext}from\"../../context/SearchContext\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Reserve=function Reserve(_ref){var setOpen=_ref.setOpen,hotelId=_ref.hotelId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedRooms=_useState2[0],setSelectedRooms=_useState2[1];var _useFetch=useFetch(\"/hotels/room/\".concat(hotelId)),data=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var _useContext=useContext(SearchContext),dates=_useContext.dates;var getDatesInRange=function getDatesInRange(startDate,endDate){var start=new Date(startDate);var end=new Date(endDate);var date=new Date(start.getTime());var dates=[];while(date<=end){dates.push(new Date(date).getTime());date.setDate(date.getDate()+1);}return dates;};var alldates=getDatesInRange(dates[0].startDate,dates[0].endDate);var isAvailable=function isAvailable(roomNumber){var isFound=roomNumber.unavailableDates.some(function(date){return alldates.includes(new Date(date).getTime());});return!isFound;};var handleSelect=function handleSelect(e){var checked=e.target.checked;var value=e.target.value;setSelectedRooms(checked?[].concat(_toConsumableArray(selectedRooms),[value]):selectedRooms.filter(function(item){return item!==value;}));};var navigate=useNavigate();var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all(selectedRooms.map(function(roomId){var res=axios.put(\"/rooms/availability/\".concat(roomId),{dates:alldates});return res.data;}));case 3:setOpen(false);navigate(\"/\");_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function handleClick(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"reserve\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rContainer\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCircleXmark,className:\"rClose\",onClick:function onClick(){return setOpen(false);}}),/*#__PURE__*/_jsx(\"span\",{children:\"Select your rooms:\"}),data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"rItem\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rItemInfo\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rTitle\",children:item.title}),/*#__PURE__*/_jsx(\"div\",{className:\"rDesc\",children:item.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"rMax\",children:[\"Max people: \",/*#__PURE__*/_jsx(\"b\",{children:item.maxPeople})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rPrice\",children:item.price})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rSelectRooms\",children:item.roomNumbers.map(function(roomNumber){return/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(\"label\",{children:roomNumber.number}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:roomNumber._id,onChange:handleSelect,disabled:!isAvailable(roomNumber)})]});})})]},item._id);}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,className:\"rButton\",children:\"Reserve Now!\"})]})});};export default Reserve;","map":{"version":3,"names":["FontAwesomeIcon","faCircleXmark","useFetch","useContext","useState","AuthContext","axios","useNavigate","Reserve","setOpen","hotelId","selectedRooms","setSelectedRooms","data","loading","error","SearchContext","dates","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","push","setDate","getDate","alldates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","navigate","handleClick","Promise","all","map","roomId","res","put","title","desc","maxPeople","price","roomNumbers","number","_id"],"sources":["/Users/arpangoel/Documents/BookingSite/client/frontend/src/components/reserve/reserve.jsx"],"sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\";\n\nimport \"./reserve.css\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useContext, useState } from \"react\";\nimport { AuthContext } from \"../../context/SearchContext\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Reserve = ({ setOpen, hotelId }) => {\n  const [selectedRooms, setSelectedRooms] = useState([]);\n  const { data, loading, error } = useFetch(`/hotels/room/${hotelId}`);\n  const { dates } = useContext(SearchContext);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n\n    const date = new Date(start.getTime());\n\n    const dates = [];\n\n    while (date <= end) {\n      dates.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return dates;\n  };\n\n  const alldates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  const isAvailable = (roomNumber) => {\n    const isFound = roomNumber.unavailableDates.some((date) =>\n      alldates.includes(new Date(date).getTime())\n    );\n\n    return !isFound;\n  };\n\n  const handleSelect = (e) => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setSelectedRooms(\n      checked\n        ? [...selectedRooms, value]\n        : selectedRooms.filter((item) => item !== value)\n    );\n  };\n\n  const navigate = useNavigate();\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(\n        selectedRooms.map((roomId) => {\n          const res = axios.put(`/rooms/availability/${roomId}`, {\n            dates: alldates,\n          });\n          return res.data;\n        })\n      );\n      setOpen(false);\n      navigate(\"/\");\n    } catch (err) {}\n  };\n  return (\n    <div className=\"reserve\">\n      <div className=\"rContainer\">\n        <FontAwesomeIcon\n          icon={faCircleXmark}\n          className=\"rClose\"\n          onClick={() => setOpen(false)}\n        />\n        <span>Select your rooms:</span>\n        {data.map((item) => (\n          <div className=\"rItem\" key={item._id}>\n            <div className=\"rItemInfo\">\n              <div className=\"rTitle\">{item.title}</div>\n              <div className=\"rDesc\">{item.desc}</div>\n              <div className=\"rMax\">\n                Max people: <b>{item.maxPeople}</b>\n              </div>\n              <div className=\"rPrice\">{item.price}</div>\n            </div>\n            <div className=\"rSelectRooms\">\n              {item.roomNumbers.map((roomNumber) => (\n                <div className=\"room\">\n                  <label>{roomNumber.number}</label>\n                  <input\n                    type=\"checkbox\"\n                    value={roomNumber._id}\n                    onChange={handleSelect}\n                    disabled={!isAvailable(roomNumber)}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n        <button onClick={handleClick} className=\"rButton\">\n          Reserve Now!\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Reserve;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}